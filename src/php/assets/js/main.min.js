"use strict";function closeAppliedForm(){var e=document.getElementById("closeAppliedForm"),t=document.querySelector(".dark-layer");e.addEventListener("click",function(){t.classList.toggle("js--hidden")})}function inputAuthorization(){document.querySelectorAll(".form-input").forEach(function(e){var t;e.value||(t=addWarningEmptySpan(),e.classList.add("form-input--warning"),e=e.id,document.querySelector("[for=".concat(e,"]")).appendChild(t))})}function addWarningEmptySpan(){var e=document.createElement("span");return e.classList.add("empty--input"),e}function deleteWarningSpans(){document.querySelectorAll(".form-input").forEach(function(t){t.addEventListener("input",function(){var e=t.id,e=document.querySelector("[for=".concat(e,"]"));e.querySelector(".empty--input")&&(e.querySelector(".empty--input").remove(),t.classList.remove("form-input--warning"))})})}var cardsArray,createServiceTotal,_updateUserOrderField,updateTotalNumber,orderList,bookedItems,darkLayer,applyBtn,closeForm,applyFormScreen,reviews,form,select;function updateUserOrderField(){var e=document.getElementById("userOrder"),t=document.querySelectorAll(".order-item"),r=document.getElementById("orderTotalPrice").textContent,n="";t.forEach(function(e){var t=e.querySelector(".order-item__name").textContent,e=e.querySelector(".order-item__price").textContent;n="".concat(n," ").concat(t," - ").concat(e,".  ")});r="Всего: ".concat(r);n+=r,e.value=n,console.log(e.value)}function makeCardsLink(){document.querySelectorAll(".container-card").forEach(function(t){t.addEventListener("click",function(){var e=t.dataset.href;console.log(e),window.location.href=e})})}function filterFeedbacksByRating(){var e=document.querySelectorAll(".feedback-item");$("#slider").slider("values");e.forEach(function(e){e.querySelector(".amount").textContent!=$("#starRating").val()?e.classList.add("js--hidden"):e.classList.remove("js--hidden")})}function filterFeedbacksByName(t){document.querySelectorAll(".feedback-item").forEach(function(e){e.querySelector(".feedback-item__caption").textContent!=t?e.classList.add("js--hidden"):e.classList.remove("js--hidden")})}$(function(){$("#orderForm").on("submit",function(e){e.preventDefault();var t=$("#userName").val(),r=$("#userPhone").val(),n=$("#userEmail").val(),e=$("#userOrder").val(),o=document.querySelector(".order-button");o.textContent="Подтверждаем",$.ajax({type:"post",url:"/wp-admin/admin-ajax.php",data:{action:"ajax_form",name:t,phone:r,mail:n,order:e},success:function(e){o.textContent=e,setTimeout(eraseLocalStorage,300),setTimeout(function(){window.location.href="https://parovoz.yurin.biz/services"},1200)}})})}),$(function(){$(".apply-form").on("submit",function(e){e.preventDefault();var t=$("#reviewName").val(),e=$("#description").val();document.querySelector(".form-button").textContent="Подтверждаем",$.ajax({type:"post",url:"/wp-admin/admin-ajax.php",data:{action:"ajax_form",name:t,description:e},success:function(e){$(".dark-layer").html(e),closeAppliedForm()}})})}),$(".order-button").on("click",function(){inputAuthorization()}),deleteWarningSpans(),Storage.prototype.setObj=function(e,t){return this.setItem(e,JSON.stringify(t))},Storage.prototype.getObj=function(e){return JSON.parse(this.getItem(e))},document.querySelector(".article-card")&&(cardsArray=document.querySelectorAll(".article-card")).forEach(function(t){t.addEventListener("mouseover",function(){var e=(e=t.style.background).replace("linear-gradient(360deg, rgba(26, 47, 68, 0.9) 0%, rgba(26, 47, 68, 0) 100%)","linear-gradient( 360deg, rgba(212, 37, 21, 0.8) 0%, rgba(212, 37, 21, 0) 100%)");t.style.background=e}),t.addEventListener("mouseout",function(){var e=(e=t.style.background).replace("linear-gradient(360deg, rgba(212, 37, 21, 0.8) 0%, rgba(212, 37, 21, 0) 100%)","linear-gradient(360deg, rgba(26, 47, 68, 0.9) 0%, rgba(26, 47, 68, 0) 100%)");t.style.background=e})}),document.getElementById("orderDate")&&(document.getElementById("orderDate").valueAsDate=new Date),window.location.href.includes("book")&&$(document).ready(function(){$("#userPhone").inputmask()}),document.querySelector(".container-card")&&setTimeout(makeCardsLink,300),window.location.href.includes("cart")&&(createServiceTotal=function(e,t,r){return'\n      <div class="order-item order-item--service" id="totalOrderID'.concat(r,'">\n        <div class="order-item__name" id="orderServiceName">').concat(e,'</div>\n        <div class="order-item__bar"> </div>\n        <div class="order-item__price" id="orderServicePrice">').concat(t," <span>₽</span></div>\n    </div>\n    ")},_updateUserOrderField=function(){var e=document.getElementById("userOrder"),t=document.querySelectorAll(".order-item"),r=document.getElementById("orderTotalPrice").textContent,n="";t.forEach(function(e){var t=e.querySelector(".order-item__name").textContent,e=e.querySelector(".order-item__price").textContent;n="".concat(n," ").concat(t," - ").concat(e,".  ")});r="Всего: ".concat(r);n+=r,e.value=n,console.log(e.value)},updateTotalNumber=function(){var e,t,r;document.querySelectorAll(".order-item__price")?(e=document.querySelectorAll(".order-item__price"),t=document.getElementById("orderTotalPrice"),r=0,e.forEach(function(e){e=parseInt(e.textContent);r+=e}),t.childNodes[0].nodeValue=r+" "):document.getElementById("orderTotalPrice").childNodes[0].nodeValue="0 "},orderList=document.querySelector(".order-list"),(bookedItems=document.querySelectorAll(".order-container")).forEach(function(e,t){var r=e.querySelector(".order-header").querySelector("a").textContent;console.log(r);e=e.querySelector(".order-cost").querySelector("span").querySelector("bdi").textContent;console.log(e),e=(e=e.match(/\d+/g))[0]+""+e[1],console.log(e);t=createServiceTotal(r,e,t);orderList.insertAdjacentHTML("beforeend",t)}),setTimeout(updateTotalNumber,100),setTimeout(_updateUserOrderField,100),$(document).ready(function(){$("#userPhone").inputmask()})),document.querySelector(".add-feedback")&&(darkLayer=document.querySelector(".dark-layer"),applyBtn=document.querySelector(".add-feedback"),closeForm=document.getElementById("closeForm"),applyFormScreen=document.getElementById("applyForm"),applyBtn.addEventListener("click",function(){darkLayer.classList.toggle("js--hidden")}),closeForm.addEventListener("click",function(){darkLayer.classList.toggle("js--hidden")}),window.onclick=function(e){e.target==darkLayer&&darkLayer.classList.toggle("js--hidden")}),window.location.href.includes("feedback")&&(reviews=document.querySelectorAll(".feedback-item")).forEach(function(e){var t=e.querySelector(".feedback-item__content").textContent,r=e.querySelector(".feedback-item__caption"),n=e.querySelector(".amount"),o=t.substring(t.indexOf("star")-1,t.indexOf("star")),a=t.substring(t.indexOf("bath")-3,t.indexOf("bath"));switch(t=(t=t.replace("".concat(a,"bath"),"")).replace("".concat(o,"star"),""),e.querySelector(".feedback-item__content").textContent=t,n.textContent=o,r.textContent=a){case"Ура":r.textContent="Уральская";break;case"Охо":r.textContent="Охотничья";break;case"Ямс":r.textContent="Ямская";break;case"Рыб":r.textContent="Рыбацкая";break;case"Раз":r.textContent="Раздольная";break;case"Сем":r.textContent="Семейная";break;case"Сиб":r.textContent="Сибирская";break;case"Лес":r.textContent="Лесная";break;case"Хут":r.textContent="Хуторок"}}),jQuery("#slider").slider({animate:"fast",max:5,min:1,step:1,range:!0,values:[1,5],slide:function(e,t){$("#starRating").val(t.value),$(".controls-section__button").removeClass("js--hidden"),filterFeedbacksByRating()}}),document.getElementById("ratingForm")&&(form=document.getElementById("ratingForm"),select=document.getElementById("bathType"),form.addEventListener("reset",function(){$("#slider").slider("values",[1,5]),$(".controls-section__button").addClass("js--hidden"),document.querySelectorAll(".feedback-item").forEach(function(e){e.classList.remove("js--hidden")})}),select.addEventListener("change",function(){$(".controls-section__button").removeClass("js--hidden"),filterFeedbacksByName($(select).val())}));var swiper=new Swiper("#workerSwiper",{direction:"horizontal",loop:!0,speed:400,spaceBetween:34,effect:"cards",slidesPerView:"4",swipeHandler:".swiper-wrapper"}),swiperImages=document.querySelectorAll(".bathroom-preview");console.log(swiperImages);var imgLinkArray=new Array,returnValue=0;swiperImages.forEach(function(e){e=e.src.replace("http://localhost:3000","."),e='<img class="swiper-preview swiper-pagination-bullet" src='.concat(e,">");imgLinkArray.push(e)});var fancySwiper=new Swiper("#fancySwiper",{direction:"horizontal",loop:!0,speed:500,spaceBetween:34,effect:"fade",fadeEffect:{crossFade:!0},slidesPerView:"1",swipeHandler:".swiper-wrapper",pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e){return imgLinkArray[e]}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFqYXguanMiLCJjb21tb24uanMiLCJmZWVkYmFjay5qcyIsInN3aXBlci5qcyJdLCJuYW1lcyI6WyJjbG9zZUFwcGxpZWRGb3JtIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImRhcmtMYXllcl9fbG9jYWwiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImlucHV0QXV0aG9yaXphdGlvbiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaW5wdXQiLCJzcGFuIiwidmFsdWUiLCJhZGRXYXJuaW5nRW1wdHlTcGFuIiwiYWRkIiwiaW5wdXRJRCIsImlkIiwiY29uY2F0IiwiYXBwZW5kQ2hpbGQiLCJ3YXJuaW5nRW1wdHlTcGFuIiwiY3JlYXRlRWxlbWVudCIsImRlbGV0ZVdhcm5pbmdTcGFucyIsImlucHV0TGFiZWwiLCJyZW1vdmUiLCJjYXJkc0FycmF5IiwiY3JlYXRlU2VydmljZVRvdGFsIiwidXBkYXRlVXNlck9yZGVyRmllbGQiLCJ1cGRhdGVUb3RhbE51bWJlciIsIm9yZGVyTGlzdCIsImJvb2tlZEl0ZW1zIiwiZGFya0xheWVyIiwiYXBwbHlCdG4iLCJjbG9zZUZvcm0iLCJhcHBseUZvcm1TY3JlZW4iLCJyZXZpZXdzIiwiZm9ybSIsInNlbGVjdCIsInVzZXJPcmRlckZpZWxkIiwidXNlck9yZGVyTGlzdCIsInRvdGFsUHJpY2UiLCJ0ZXh0Q29udGVudCIsIm9yZGVyU3RyaW5nIiwib3JkZXIiLCJvcmRlck5hbWUiLCJvcmRlclByaWNlIiwidG90YWxTdHJpbmciLCJjb25zb2xlIiwibG9nIiwibWFrZUNhcmRzTGluayIsImNhcmQiLCJsaW5rIiwiZGF0YXNldCIsImhyZWYiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImZpbHRlckZlZWRiYWNrc0J5UmF0aW5nIiwiYWxsRmVlZGJhY2tzIiwiJCIsInNsaWRlciIsImZlZWRiYWNrIiwidmFsIiwiZmlsdGVyRmVlZGJhY2tzQnlOYW1lIiwiY2hlY2tlZFZhbHVlIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJuYW1lIiwicGhvbmUiLCJtYWlsIiwib3JkZXJCdXR0b24iLCJhamF4IiwidHlwZSIsInVybCIsImRhdGEiLCJhY3Rpb24iLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzZXRUaW1lb3V0IiwiZXJhc2VMb2NhbFN0b3JhZ2UiLCJkZXNjcmlwdGlvbiIsImh0bWwiLCJTdG9yYWdlIiwicHJvdG90eXBlIiwic2V0T2JqIiwia2V5Iiwib2JqIiwidGhpcyIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0T2JqIiwicGFyc2UiLCJnZXRJdGVtIiwiYmFja2dyb3VuZCIsInN0eWxlIiwicmVwbGFjZSIsInZhbHVlQXNEYXRlIiwiRGF0ZSIsImluY2x1ZGVzIiwicmVhZHkiLCJpbnB1dG1hc2siLCJwcmljZSIsImFsbE9yZGVyc051bXMiLCJ0b3RhbE51bSIsInRvdGFsU3VtIiwicmVhbFByaWNlIiwicGFyc2VJbnQiLCJjaGlsZE5vZGVzIiwibm9kZVZhbHVlIiwiaW5kZXgiLCJzZXJ2aWNlTmFtZSIsInNlcnZpY2VQcmljZSIsIm1hdGNoIiwidG90YWxPcmRlciIsImluc2VydEFkamFjZW50SFRNTCIsIm9uY2xpY2siLCJldmVudCIsInRhcmdldCIsInJldmlldyIsInJldmlld19jb250ZW50IiwiYmF0aF90eXBlX25hbWUiLCJzdGFyX3JhdGluZ19hbW91bnQiLCJzdGFyX3JhdGluZyIsInN1YnN0cmluZyIsImluZGV4T2YiLCJiYXRoX3R5cGUiLCJqUXVlcnkiLCJhbmltYXRlIiwibWF4IiwibWluIiwic3RlcCIsInJhbmdlIiwidmFsdWVzIiwic2xpZGUiLCJ1aSIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJzd2lwZXIiLCJTd2lwZXIiLCJkaXJlY3Rpb24iLCJsb29wIiwic3BlZWQiLCJzcGFjZUJldHdlZW4iLCJlZmZlY3QiLCJzbGlkZXNQZXJWaWV3Iiwic3dpcGVIYW5kbGVyIiwic3dpcGVySW1hZ2VzIiwiaW1nTGlua0FycmF5IiwiQXJyYXkiLCJyZXR1cm5WYWx1ZSIsImltYWdlIiwiaW1hZ2VTcmMiLCJzcmMiLCJwdXNoIiwiZmFuY3lTd2lwZXIiLCJmYWRlRWZmZWN0IiwiY3Jvc3NGYWRlIiwicGFnaW5hdGlvbiIsImVsIiwiY2xpY2thYmxlIiwicmVuZGVyQnVsbGV0Il0sIm1hcHBpbmdzIjoiYUFzREEsU0FBQUEsbUJBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsZUFBQSxvQkFDQUMsRUFBQUYsU0FBQUcsY0FBQSxlQUNBSixFQUFBSyxpQkFBQSxRQUFBLFdBQ0FGLEVBQUFHLFVBQUFDLE9BQUEsZ0JBU0EsU0FBQUMscUJBQ0FQLFNBQUFRLGlCQUFBLGVBQ0FDLFFBQUEsU0FBQUMsR0FDQSxJQUNBQyxFQURBRCxFQUFBRSxRQUNBRCxFQUFBRSxzQkFDQUgsRUFBQUwsVUFBQVMsSUFBQSx1QkFDQUMsRUFBQUwsRUFBQU0sR0FDQWhCLFNBQUFHLGNBQUEsUUFBQWMsT0FBQUYsRUFBQSxNQUNBRyxZQUFBUCxNQU1BLFNBQUFFLHNCQUNBLElBQUFNLEVBQUFuQixTQUFBb0IsY0FBQSxRQUVBLE9BREFELEVBQUFkLFVBQUFTLElBQUEsZ0JBQ0FLLEVBR0EsU0FBQUUscUJBQ0FyQixTQUFBUSxpQkFBQSxlQUNBQyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFOLGlCQUFBLFFBQUEsV0FDQSxJQUFBVyxFQUFBTCxFQUFBTSxHQUNBTSxFQUFBdEIsU0FBQUcsY0FBQSxRQUFBYyxPQUFBRixFQUFBLE1BQ0FPLEVBQUFuQixjQUFBLG1CQUNBbUIsRUFBQW5CLGNBQUEsaUJBQ0FvQixTQUNBYixFQUFBTCxVQUFBa0IsT0FBQSw0QkN6RkEsSUFDQUMsV0FxRkFDLG1CQVlBQyxzQkFnQkFDLGtCQTVDQUMsVUFDQUMsWUF5RUFDLFVBQ0FDLFNBQ0FDLFVBQ0FDLGdCQW1CQUMsUUM5SkFDLEtBQ0FDLE9EaUJBLFNBQUFWLHVCQUNBLElBQUFXLEVBQUFyQyxTQUFBQyxlQUFBLGFBQ0FxQyxFQUFBdEMsU0FBQVEsaUJBQUEsZUFDQStC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RCxTQUFBQyxlQUFBLGdCQUNBa0MsS0FBQW5DLFNBQUFDLGVBQUEsY0FDQW1DLE9BQUFwQyxTQUFBQyxlQUFBLFlBQ0FrQyxLQUFBL0IsaUJBQUEsUUFBQSxXQUNBcUQsRUFBQSxXQUFBQyxPQUFBLFNBQUEsQ0FBQSxFQUFBLElBQ0FELEVBQUEsNkJBQUErRSxTQUFBLGNBRUF4SSxTQUFBUSxpQkFBQSxrQkFDQUMsUUFBQSxTQUFBa0QsR0FFQUEsRUFBQXRELFVBQUFrQixPQUFBLGtCQUdBYSxPQUFBaEMsaUJBQUEsU0FBQSxXQUNBcUQsRUFBQSw2QkFBQThFLFlBQUEsY0FFQTFFLHNCQURBSixFQUFBckIsUUFBQXdCLFVDN0JBLElBQUE2RSxPQUFBLElBQUFDLE9BQUEsZ0JBQUEsQ0FFQUMsVUFBQSxhQUNBQyxNQUFBLEVBQ0FDLE1BQUEsSUFDQUMsYUFBQSxHQUNBQyxPQUFBLFFBQ0FDLGNBQUEsSUFDQUMsYUFBQSxvQkFFQUMsYUFBQWxKLFNBQUFRLGlCQUFBLHFCQUNBc0MsUUFBQUMsSUFBQW1HLGNBQ0EsSUFBQUMsYUFBQSxJQUFBQyxNQUNBQyxZQUFBLEVBQ0FILGFBQUF6SSxRQUFBLFNBQUE2SSxHQUNBQyxFQUFBRCxFQUFBRSxJQUFBekQsUUFBQSx3QkFBQSxLQUNBc0QsRUFBQSw0REFBQXBJLE9BQUFzSSxFQUFBLEtBQ0FKLGFBQUFNLEtBQUFKLEtBR0EsSUFBQUssWUFBQSxJQUFBaEIsT0FBQSxlQUFBLENBQ0FDLFVBQUEsYUFDQUMsTUFBQSxFQUNBQyxNQUFBLElBQ0FDLGFBQUEsR0FDQUMsT0FBQSxPQUNBWSxXQUFBLENBQ0FDLFdBQUEsR0FFQVosY0FBQSxJQUNBQyxhQUFBLGtCQUNBWSxXQUFBLENBQ0FDLEdBQUEscUJBQ0FDLFdBQUEsRUFDQUMsYUFBQSxTQUFBbkQsR0FDQSxPQUFBc0MsYUFBQXRDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBSkFYLdC30LDQv9GA0L7RgSDQtNC70Y8g0L7RgtC/0YDQsNCy0LrQuCDRgdC+0L7QsdGJ0LXQvdC40Lkg0L3QsCDQv9C+0YfRgtGDLCDQutC+0YLQvtGA0LDRjyDRg9C60LDQt9Cw0L3QsCDQsiDQsNC00LzQuNC90LrQtSDRgdCw0LnRgtCwXG4kKGZ1bmN0aW9uICgpIHtcbiAgICAkKFwiI29yZGVyRm9ybVwiKS5vbihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciBuYW1lID0gJChcIiN1c2VyTmFtZVwiKS52YWwoKTtcbiAgICAgICAgdmFyIHBob25lID0gJChcIiN1c2VyUGhvbmVcIikudmFsKCk7XG4gICAgICAgIHZhciBtYWlsID0gJChcIiN1c2VyRW1haWxcIikudmFsKCk7XG4gICAgICAgIHZhciBvcmRlciA9ICQoXCIjdXNlck9yZGVyXCIpLnZhbCgpO1xuICAgICAgICB2YXIgb3JkZXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub3JkZXItYnV0dG9uJyk7XG4gICAgICAgIG9yZGVyQnV0dG9uLnRleHRDb250ZW50ID0gXCLQn9C+0LTRgtCy0LXRgNC20LTQsNC10LxcIjtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogXCJwb3N0XCIsXG4gICAgICAgICAgICB1cmw6IFwiL3dwLWFkbWluL2FkbWluLWFqYXgucGhwXCIsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBcImFqYXhfZm9ybVwiLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLFxuICAgICAgICAgICAgICAgIG1haWw6IG1haWwsXG4gICAgICAgICAgICAgICAgb3JkZXI6IG9yZGVyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG9yZGVyQnV0dG9uLnRleHRDb250ZW50ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChlcmFzZUxvY2FsU3RvcmFnZSwgMzAwKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHBzOi8vcGFyb3Zvei55dXJpbi5iaXovc2VydmljZXNcIjtcbiAgICAgICAgICAgICAgICB9LCAxMjAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4kKGZ1bmN0aW9uICgpIHtcbiAgICAkKFwiLmFwcGx5LWZvcm1cIikub24oXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgbmFtZSA9ICQoXCIjcmV2aWV3TmFtZVwiKS52YWwoKTtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gJChcIiNkZXNjcmlwdGlvblwiKS52YWwoKTtcbiAgICAgICAgdmFyIG9yZGVyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tYnV0dG9uJyk7XG4gICAgICAgIG9yZGVyQnV0dG9uLnRleHRDb250ZW50ID0gXCLQn9C+0LTRgtCy0LXRgNC20LTQsNC10LxcIjtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogXCJwb3N0XCIsXG4gICAgICAgICAgICB1cmw6IFwiL3dwLWFkbWluL2FkbWluLWFqYXgucGhwXCIsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBcImFqYXhfZm9ybVwiLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICQoXCIuZGFyay1sYXllclwiKS5odG1sKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBjbG9zZUFwcGxpZWRGb3JtKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuZnVuY3Rpb24gY2xvc2VBcHBsaWVkRm9ybSgpIHtcbiAgICBjb25zdCBjbG9zZUFwcGxpZWRGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZUFwcGxpZWRGb3JtXCIpO1xuICAgIGNvbnN0IGRhcmtMYXllcl9fbG9jYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhcmstbGF5ZXJcIik7XG4gICAgY2xvc2VBcHBsaWVkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBkYXJrTGF5ZXJfX2xvY2FsLmNsYXNzTGlzdC50b2dnbGUoXCJqcy0taGlkZGVuXCIpO1xuICAgIH0pO1xufVxuLy8g0J/RgNC+0LLQtdGA0Y/QtdC8LCDRh9GC0L4g0LLRgdC1INC/0L7Qu9GPINCy0LDQttC90YvQtSDQt9Cw0L/QvtC70L3QtdC90YtcbiQoXCIub3JkZXItYnV0dG9uXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgIGlucHV0QXV0aG9yaXphdGlvbigpO1xufSk7XG4vLyAgIFxuLy8g0KHQsNC80LAg0YTRg9C90LrRhtC40Y8g0L/RgNC+0LLQtdGA0LrQuCDQv9C+0LvQtdC5INC4INC00L7QsdCw0LLQu9C10L3QuNGPINC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0YUg0YHQstC+0LnRgdGC0LIg0L/QvtC70Y5cbmZ1bmN0aW9uIGlucHV0QXV0aG9yaXphdGlvbigpIHtcbiAgICBjb25zdCBpbnB1dHNBcnJheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1pbnB1dFwiKTtcbiAgICBpbnB1dHNBcnJheS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICBpZiAoIWlucHV0LnZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCBzcGFuID0gYWRkV2FybmluZ0VtcHR5U3BhbigpO1xuICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcImZvcm0taW5wdXQtLXdhcm5pbmdcIik7XG4gICAgICAgICAgICBjb25zdCBpbnB1dElEID0gaW5wdXQuaWQ7XG4gICAgICAgICAgICBjb25zdCBpbnB1dExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2Zvcj0ke2lucHV0SUR9XWApO1xuICAgICAgICAgICAgaW5wdXRMYWJlbC5hcHBlbmRDaGlsZChzcGFuKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4vLyDQndC1INGF0L7RgtC10Lsg0L/QtdGA0LXQs9GA0YPQttCw0YLRjCDRhNGD0L3QutGG0LjRjyDQv9GA0L7QstC10YDQutC4INC4INC/0YDQvtGH0LXQtSwg0L/QvtGN0YLQvtC80YMg0YHQvtC30LTQsNC90LjQtSDQvtGC0LTQtdC70YzQvdC+0LPQviDRgdC/0LDQvdCwINCy0YvQvdC10YEg0L7RgtC00LXQu9GM0L3QvlxuZnVuY3Rpb24gYWRkV2FybmluZ0VtcHR5U3BhbigpIHtcbiAgICBjb25zdCB3YXJuaW5nRW1wdHlTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgd2FybmluZ0VtcHR5U3Bhbi5jbGFzc0xpc3QuYWRkKFwiZW1wdHktLWlucHV0XCIpO1xuICAgIHJldHVybiB3YXJuaW5nRW1wdHlTcGFuO1xufVxuLy8g0JrQsNC6INGC0L7Qu9GM0LrQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0YDQtdGI0LjQu9GB0Y8g0LLQstC10YHRgtC4INC00LDQvdC90YvQtSwg0LXRgdC70Lgg0LHRi9C70L4g0L/RgNC10LTRg9C/0YDQtdC20LTQtdC90LjQtSDRjyDRg9C00LDQu9GP0Y4g0L/RgNC10LTRg9C/0YDQtdC20LTQtdC90LjRjyDQstGB0Y/QutC40LVcbmZ1bmN0aW9uIGRlbGV0ZVdhcm5pbmdTcGFucygpIHtcbiAgICBjb25zdCBpbnB1dHNBcnJheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybS1pbnB1dFwiKTtcbiAgICBpbnB1dHNBcnJheS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5wdXRJRCA9IGlucHV0LmlkO1xuICAgICAgICAgICAgY29uc3QgaW5wdXRMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtmb3I9JHtpbnB1dElEfV1gKTtcbiAgICAgICAgICAgIGlmIChpbnB1dExhYmVsLnF1ZXJ5U2VsZWN0b3IoXCIuZW1wdHktLWlucHV0XCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VydGFpblNwYW4gPSBpbnB1dExhYmVsLnF1ZXJ5U2VsZWN0b3IoXCIuZW1wdHktLWlucHV0XCIpO1xuICAgICAgICAgICAgICAgIGNlcnRhaW5TcGFuLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJmb3JtLWlucHV0LS13YXJuaW5nXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZGVsZXRlV2FybmluZ1NwYW5zKCk7XG5cbiIsIlN0b3JhZ2UucHJvdG90eXBlLnNldE9iaiA9IGZ1bmN0aW9uIChrZXksIG9iaikge1xuICByZXR1cm4gdGhpcy5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkob2JqKSlcbn1cblN0b3JhZ2UucHJvdG90eXBlLmdldE9iaiA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5nZXRJdGVtKGtleSkpXG59XG5cbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFydGljbGUtY2FyZFwiKSkge1xuICBjb25zdCBjYXJkc0FycmF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcnRpY2xlLWNhcmRcIik7XG4gIGNhcmRzQXJyYXkuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG4gICAgICBsZXQgYmFja2dyb3VuZCA9IGNhcmQuc3R5bGUuYmFja2dyb3VuZDtcbiAgICAgIGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kLnJlcGxhY2UoXG4gICAgICAgIFwibGluZWFyLWdyYWRpZW50KDM2MGRlZywgcmdiYSgyNiwgNDcsIDY4LCAwLjkpIDAlLCByZ2JhKDI2LCA0NywgNjgsIDApIDEwMCUpXCIsXG4gICAgICAgIFwibGluZWFyLWdyYWRpZW50KCAzNjBkZWcsIHJnYmEoMjEyLCAzNywgMjEsIDAuOCkgMCUsIHJnYmEoMjEyLCAzNywgMjEsIDApIDEwMCUpXCJcbiAgICAgICk7XG4gICAgICBjYXJkLnN0eWxlLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kO1xuICAgIH0pO1xuICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcbiAgICAgIGxldCBiYWNrZ3JvdW5kID0gY2FyZC5zdHlsZS5iYWNrZ3JvdW5kO1xuICAgICAgYmFja2dyb3VuZCA9IGJhY2tncm91bmQucmVwbGFjZShcbiAgICAgICAgXCJsaW5lYXItZ3JhZGllbnQoMzYwZGVnLCByZ2JhKDIxMiwgMzcsIDIxLCAwLjgpIDAlLCByZ2JhKDIxMiwgMzcsIDIxLCAwKSAxMDAlKVwiLFxuICAgICAgICBcImxpbmVhci1ncmFkaWVudCgzNjBkZWcsIHJnYmEoMjYsIDQ3LCA2OCwgMC45KSAwJSwgcmdiYSgyNiwgNDcsIDY4LCAwKSAxMDAlKVwiXG4gICAgICApO1xuICAgICAgY2FyZC5zdHlsZS5iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcbiAgICB9KTtcbiAgfSk7XG59XG5pZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcmRlckRhdGVcIikpIHtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3JkZXJEYXRlJykudmFsdWVBc0RhdGUgPSBuZXcgRGF0ZSgpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVVc2VyT3JkZXJGaWVsZCgpIHtcbiAgY29uc3QgdXNlck9yZGVyRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXJPcmRlclwiKTtcbiAgY29uc3QgdXNlck9yZGVyTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIub3JkZXItaXRlbVwiKTtcbiAgY29uc3QgdG90YWxQcmljZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3JkZXJUb3RhbFByaWNlXCIpLnRleHRDb250ZW50O1xuICBsZXQgb3JkZXJTdHJpbmcgPSAnJztcbiAgdXNlck9yZGVyTGlzdC5mb3JFYWNoKG9yZGVyID0+IHtcbiAgICBjb25zdCBvcmRlck5hbWUgPSBvcmRlci5xdWVyeVNlbGVjdG9yKFwiLm9yZGVyLWl0ZW1fX25hbWVcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc3Qgb3JkZXJQcmljZSA9IG9yZGVyLnF1ZXJ5U2VsZWN0b3IoXCIub3JkZXItaXRlbV9fcHJpY2VcIikudGV4dENvbnRlbnQ7XG4gICAgb3JkZXJTdHJpbmcgPSBgJHtvcmRlclN0cmluZ30gJHtvcmRlck5hbWV9IC0gJHtvcmRlclByaWNlfS4gIGBcbiAgfSk7XG4gIGxldCB0b3RhbFN0cmluZyA9IGDQktGB0LXQs9C+OiAke3RvdGFsUHJpY2V9YDtcbiAgb3JkZXJTdHJpbmcgKz0gdG90YWxTdHJpbmc7XG4gIHVzZXJPcmRlckZpZWxkLnZhbHVlID0gb3JkZXJTdHJpbmc7XG4gIGNvbnNvbGUubG9nKHVzZXJPcmRlckZpZWxkLnZhbHVlKTtcbn1cblxuXG5pZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoXCJib29rXCIpKSB7XG5cbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICQoXCIjdXNlclBob25lXCIpLmlucHV0bWFzaygpO1xuICB9KTtcblxufVxuXG5pZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250YWluZXItY2FyZFwiKSkge1xuICBzZXRUaW1lb3V0KG1ha2VDYXJkc0xpbmssIDMwMClcbn1cblxuZnVuY3Rpb24gbWFrZUNhcmRzTGluaygpIHtcbiAgY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvbnRhaW5lci1jYXJkXCIpO1xuXG4gIGNhcmRzLmZvckVhY2goY2FyZCA9PiB7XG4gICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGxpbmsgPSBjYXJkLmRhdGFzZXQuaHJlZjtcbiAgICAgIGNvbnNvbGUubG9nKGxpbmspO1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBsaW5rO1xuICAgIH0pXG4gIH0pXG59XG5cblxuXG5pZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoXCJjYXJ0XCIpKSB7XG4gIHZhciBvcmRlckxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm9yZGVyLWxpc3RcIik7XG4gIGNvbnN0IGJvb2tlZEl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5vcmRlci1jb250YWluZXJcIilcbiAgYm9va2VkSXRlbXMuZm9yRWFjaCgob3JkZXIsIGluZGV4KSA9PiB7XG4gICAgY29uc3Qgc2VydmljZU5hbWUgPSBvcmRlci5xdWVyeVNlbGVjdG9yKCcub3JkZXItaGVhZGVyJykucXVlcnlTZWxlY3RvcihcImFcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc29sZS5sb2coc2VydmljZU5hbWUpO1xuICAgIGxldCBzZXJ2aWNlUHJpY2UgPSBvcmRlci5xdWVyeVNlbGVjdG9yKCcub3JkZXItY29zdCcpLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuXCIpLnF1ZXJ5U2VsZWN0b3IoXCJiZGlcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc29sZS5sb2coc2VydmljZVByaWNlKTtcbiAgICBzZXJ2aWNlUHJpY2UgPSBzZXJ2aWNlUHJpY2UubWF0Y2goL1xcZCsvZyk7XG4gICAgc2VydmljZVByaWNlID0gc2VydmljZVByaWNlWzBdICsgJycgKyBzZXJ2aWNlUHJpY2VbMV07XG4gICAgY29uc29sZS5sb2coc2VydmljZVByaWNlKTtcbiAgICBjb25zdCBzZXJ2aWNlQ291bnRlciA9IGluZGV4O1xuXG4gICAgY29uc3QgdG90YWxPcmRlciA9IGNyZWF0ZVNlcnZpY2VUb3RhbChzZXJ2aWNlTmFtZSwgc2VydmljZVByaWNlLCBpbmRleCk7XG4gICAgb3JkZXJMaXN0Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgdG90YWxPcmRlcik7XG4gIH0pXG5cbiAgZnVuY3Rpb24gY3JlYXRlU2VydmljZVRvdGFsKG5hbWUsIHByaWNlLCBpZCkge1xuICAgIGNvbnN0IEhUTUxTdHJpbmcgPVxuICAgICAgYFxuICAgICAgPGRpdiBjbGFzcz1cIm9yZGVyLWl0ZW0gb3JkZXItaXRlbS0tc2VydmljZVwiIGlkPVwidG90YWxPcmRlcklEJHtpZH1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm9yZGVyLWl0ZW1fX25hbWVcIiBpZD1cIm9yZGVyU2VydmljZU5hbWVcIj4ke25hbWV9PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJvcmRlci1pdGVtX19iYXJcIj4gPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJvcmRlci1pdGVtX19wcmljZVwiIGlkPVwib3JkZXJTZXJ2aWNlUHJpY2VcIj4ke3ByaWNlfSA8c3Bhbj7igr08L3NwYW4+PC9kaXY+XG4gICAgPC9kaXY+XG4gICAgYDtcbiAgICByZXR1cm4gSFRNTFN0cmluZztcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZVVzZXJPcmRlckZpZWxkKCkge1xuICAgIGNvbnN0IHVzZXJPcmRlckZpZWxkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1c2VyT3JkZXJcIik7XG4gICAgY29uc3QgdXNlck9yZGVyTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIub3JkZXItaXRlbVwiKTtcbiAgICBjb25zdCB0b3RhbFByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcmRlclRvdGFsUHJpY2VcIikudGV4dENvbnRlbnQ7XG4gICAgbGV0IG9yZGVyU3RyaW5nID0gJyc7XG4gICAgdXNlck9yZGVyTGlzdC5mb3JFYWNoKG9yZGVyID0+IHtcbiAgICAgIGNvbnN0IG9yZGVyTmFtZSA9IG9yZGVyLnF1ZXJ5U2VsZWN0b3IoXCIub3JkZXItaXRlbV9fbmFtZVwiKS50ZXh0Q29udGVudDtcbiAgICAgIGNvbnN0IG9yZGVyUHJpY2UgPSBvcmRlci5xdWVyeVNlbGVjdG9yKFwiLm9yZGVyLWl0ZW1fX3ByaWNlXCIpLnRleHRDb250ZW50O1xuICAgICAgb3JkZXJTdHJpbmcgPSBgJHtvcmRlclN0cmluZ30gJHtvcmRlck5hbWV9IC0gJHtvcmRlclByaWNlfS4gIGBcbiAgICB9KTtcbiAgICBsZXQgdG90YWxTdHJpbmcgPSBg0JLRgdC10LPQvjogJHt0b3RhbFByaWNlfWA7XG4gICAgb3JkZXJTdHJpbmcgKz0gdG90YWxTdHJpbmc7XG4gICAgdXNlck9yZGVyRmllbGQudmFsdWUgPSBvcmRlclN0cmluZztcbiAgICBjb25zb2xlLmxvZyh1c2VyT3JkZXJGaWVsZC52YWx1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVUb3RhbE51bWJlcigpIHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5vcmRlci1pdGVtX19wcmljZVwiKSkge1xuICAgICAgY29uc3QgYWxsT3JkZXJzTnVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIub3JkZXItaXRlbV9fcHJpY2VcIik7XG4gICAgICBjb25zdCB0b3RhbE51bSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3JkZXJUb3RhbFByaWNlXCIpO1xuICAgICAgbGV0IHRvdGFsU3VtID0gMDtcbiAgICAgIGFsbE9yZGVyc051bXMuZm9yRWFjaChwcmljZSA9PiB7XG4gICAgICAgIHZhciByZWFsUHJpY2UgPSBwYXJzZUludChwcmljZS50ZXh0Q29udGVudClcbiAgICAgICAgdG90YWxTdW0gKz0gcmVhbFByaWNlO1xuICAgICAgfSlcbiAgICAgIGxldCB0b3RhbE51bUZpbmFsID0gdG90YWxOdW0uY2hpbGROb2Rlc1swXTtcbiAgICAgIHRvdGFsTnVtRmluYWwubm9kZVZhbHVlID0gdG90YWxTdW0gKyAnICc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgdG90YWxOdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm9yZGVyVG90YWxQcmljZVwiKTtcbiAgICAgIGxldCB0b3RhbFN1bSA9IDA7XG4gICAgICBsZXQgdG90YWxOdW1GaW5hbCA9IHRvdGFsTnVtLmNoaWxkTm9kZXNbMF07XG4gICAgICB0b3RhbE51bUZpbmFsLm5vZGVWYWx1ZSA9IHRvdGFsU3VtICsgJyAnO1xuICAgIH1cbiAgfVxuICBzZXRUaW1lb3V0KHVwZGF0ZVRvdGFsTnVtYmVyLCAxMDApXG4gIHNldFRpbWVvdXQodXBkYXRlVXNlck9yZGVyRmllbGQsIDEwMClcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICQoXCIjdXNlclBob25lXCIpLmlucHV0bWFzaygpO1xuICB9KTtcblxufVxuXG5cblxuaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLWZlZWRiYWNrXCIpKSB7XG4gIGNvbnN0IGRhcmtMYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGFyay1sYXllclwiKTtcbiAgY29uc3QgYXBwbHlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1mZWVkYmFja1wiKTtcbiAgY29uc3QgY2xvc2VGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZUZvcm1cIik7XG4gIGNvbnN0IGFwcGx5Rm9ybVNjcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXBwbHlGb3JtXCIpO1xuICBhcHBseUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgZGFya0xheWVyLmNsYXNzTGlzdC50b2dnbGUoXCJqcy0taGlkZGVuXCIpO1xuICB9KVxuXG4gIGNsb3NlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGRhcmtMYXllci5jbGFzc0xpc3QudG9nZ2xlKFwianMtLWhpZGRlblwiKTtcbiAgfSk7XG5cbiAgd2luZG93Lm9uY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ID09IGRhcmtMYXllcikge1xuICAgICAgZGFya0xheWVyLmNsYXNzTGlzdC50b2dnbGUoXCJqcy0taGlkZGVuXCIpO1xuICAgIH1cbiAgfTtcbn1cblxuXG5pZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoXCJmZWVkYmFja1wiKSkge1xuICBjb25zdCByZXZpZXdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZlZWRiYWNrLWl0ZW0nKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgbGV0IHJldmlld19jb250ZW50ID0gcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJy5mZWVkYmFjay1pdGVtX19jb250ZW50JykudGV4dENvbnRlbnQ7XG4gICAgY29uc3QgYmF0aF90eXBlX25hbWUgPSByZXZpZXcucXVlcnlTZWxlY3RvcignLmZlZWRiYWNrLWl0ZW1fX2NhcHRpb24nKTtcbiAgICBjb25zdCBzdGFyX3JhdGluZ19hbW91bnQgPSByZXZpZXcucXVlcnlTZWxlY3RvcignLmFtb3VudCcpO1xuICAgIGNvbnN0IHN0YXJfcmF0aW5nID0gcmV2aWV3X2NvbnRlbnQuc3Vic3RyaW5nKHJldmlld19jb250ZW50LmluZGV4T2YoXCJzdGFyXCIpIC0gMSwgcmV2aWV3X2NvbnRlbnQuaW5kZXhPZihcInN0YXJcIikpO1xuICAgIGNvbnN0IGJhdGhfdHlwZSA9IHJldmlld19jb250ZW50LnN1YnN0cmluZyhyZXZpZXdfY29udGVudC5pbmRleE9mKFwiYmF0aFwiKSAtIDMsIHJldmlld19jb250ZW50LmluZGV4T2YoXCJiYXRoXCIpKTtcbiAgICByZXZpZXdfY29udGVudCA9IHJldmlld19jb250ZW50LnJlcGxhY2UoYCR7YmF0aF90eXBlfWJhdGhgLCAnJylcbiAgICByZXZpZXdfY29udGVudCA9IHJldmlld19jb250ZW50LnJlcGxhY2UoYCR7c3Rhcl9yYXRpbmd9c3RhcmAsICcnKVxuICAgIHJldmlldy5xdWVyeVNlbGVjdG9yKCcuZmVlZGJhY2staXRlbV9fY29udGVudCcpLnRleHRDb250ZW50ID0gcmV2aWV3X2NvbnRlbnQ7XG4gICAgc3Rhcl9yYXRpbmdfYW1vdW50LnRleHRDb250ZW50ID0gc3Rhcl9yYXRpbmdcbiAgICBiYXRoX3R5cGVfbmFtZS50ZXh0Q29udGVudCA9IGJhdGhfdHlwZVxuICAgIHN3aXRjaCAoYmF0aF90eXBlKSB7XG4gICAgICBjYXNlICfQo9GA0LAnOlxuICAgICAgICBiYXRoX3R5cGVfbmFtZS50ZXh0Q29udGVudCA9ICfQo9GA0LDQu9GM0YHQutCw0Y8nXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAn0J7RhdC+JzpcbiAgICAgICAgYmF0aF90eXBlX25hbWUudGV4dENvbnRlbnQgPSAn0J7RhdC+0YLQvdC40YfRjNGPJ1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ9Cv0LzRgSc6XG4gICAgICAgIGJhdGhfdHlwZV9uYW1lLnRleHRDb250ZW50ID0gJ9Cv0LzRgdC60LDRjydcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICfQoNGL0LEnOlxuICAgICAgICBiYXRoX3R5cGVfbmFtZS50ZXh0Q29udGVudCA9ICfQoNGL0LHQsNGG0LrQsNGPJ1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ9Cg0LDQtyc6XG4gICAgICAgIGJhdGhfdHlwZV9uYW1lLnRleHRDb250ZW50ID0gJ9Cg0LDQt9C00L7Qu9GM0L3QsNGPJ1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ9Ch0LXQvCc6XG4gICAgICAgIGJhdGhfdHlwZV9uYW1lLnRleHRDb250ZW50ID0gJ9Ch0LXQvNC10LnQvdCw0Y8nXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAn0KHQuNCxJzpcbiAgICAgICAgYmF0aF90eXBlX25hbWUudGV4dENvbnRlbnQgPSAn0KHQuNCx0LjRgNGB0LrQsNGPJ1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ9Cb0LXRgSc6XG4gICAgICAgIGJhdGhfdHlwZV9uYW1lLnRleHRDb250ZW50ID0gJ9Cb0LXRgdC90LDRjydcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICfQpdGD0YInOlxuICAgICAgICBiYXRoX3R5cGVfbmFtZS50ZXh0Q29udGVudCA9ICfQpdGD0YLQvtGA0L7QuidcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9KVxufSIsImpRdWVyeShcIiNzbGlkZXJcIikuc2xpZGVyKHtcbiAgICBhbmltYXRlOiBcImZhc3RcIixcbiAgICBtYXg6IDUsXG4gICAgbWluOiAxLFxuICAgIHN0ZXA6IDEsXG4gICAgcmFuZ2U6IHRydWUsXG4gICAgdmFsdWVzOiBbMSwgNV0sXG4gICAgc2xpZGU6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcbiAgICAgICAgJChcIiNzdGFyUmF0aW5nXCIpLnZhbCh1aS52YWx1ZSk7XG4gICAgICAgICQoXCIuY29udHJvbHMtc2VjdGlvbl9fYnV0dG9uXCIpLnJlbW92ZUNsYXNzKFwianMtLWhpZGRlblwiKTtcbiAgICAgICAgZmlsdGVyRmVlZGJhY2tzQnlSYXRpbmcoKVxuICAgIH1cbn0pO1xuXG5pZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyYXRpbmdGb3JtXCIpKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmF0aW5nRm9ybVwiKTtcbiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhdGhUeXBlXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgICAgJChcIiNzbGlkZXJcIikuc2xpZGVyKFwidmFsdWVzXCIsIFsxLCA1XSlcbiAgICAgICAgJChcIi5jb250cm9scy1zZWN0aW9uX19idXR0b25cIikuYWRkQ2xhc3MoXCJqcy0taGlkZGVuXCIpO1xuXG4gICAgICAgIHZhciBhbGxGZWVkYmFja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmVlZGJhY2staXRlbScpO1xuICAgICAgICBhbGxGZWVkYmFja3MuZm9yRWFjaChmZWVkYmFjayA9PiB7XG5cbiAgICAgICAgICAgIGZlZWRiYWNrLmNsYXNzTGlzdC5yZW1vdmUoXCJqcy0taGlkZGVuXCIpO1xuICAgICAgICB9KTtcbiAgICB9KVxuICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgICAgICAgJChcIi5jb250cm9scy1zZWN0aW9uX19idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJqcy0taGlkZGVuXCIpXG4gICAgICAgIHZhciBjaGVja2VkT3B0aW9uID0gJChzZWxlY3QpLnZhbCgpO1xuICAgICAgICBmaWx0ZXJGZWVkYmFja3NCeU5hbWUoY2hlY2tlZE9wdGlvbilcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyRmVlZGJhY2tzQnlSYXRpbmcoKSB7XG4gICAgdmFyIGFsbEZlZWRiYWNrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mZWVkYmFjay1pdGVtJyk7XG4gICAgdmFyIHN0YXJSYXRpbmcgPSAkKFwiI3NsaWRlclwiKS5zbGlkZXIoXCJ2YWx1ZXNcIik7XG5cbiAgICBhbGxGZWVkYmFja3MuZm9yRWFjaChmZWVkYmFjayA9PiB7XG4gICAgICAgIGlmIChmZWVkYmFjay5xdWVyeVNlbGVjdG9yKFwiLmFtb3VudFwiKS50ZXh0Q29udGVudCAhPVxuICAgICAgICAgICAgJChcIiNzdGFyUmF0aW5nXCIpLnZhbCgpKSB7XG4gICAgICAgICAgICBmZWVkYmFjay5jbGFzc0xpc3QuYWRkKFwianMtLWhpZGRlblwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZlZWRiYWNrLmNsYXNzTGlzdC5yZW1vdmUoXCJqcy0taGlkZGVuXCIpO1xuICAgICAgICB9XG4gICAgfSlcblxufVxuZnVuY3Rpb24gZmlsdGVyRmVlZGJhY2tzQnlOYW1lKGNoZWNrZWRWYWx1ZSkge1xuICAgIHZhciBhbGxGZWVkYmFja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmVlZGJhY2staXRlbScpO1xuICAgIGFsbEZlZWRiYWNrcy5mb3JFYWNoKGZlZWRiYWNrID0+IHtcblxuICAgICAgICBpZiAoZmVlZGJhY2sucXVlcnlTZWxlY3RvcihcIi5mZWVkYmFjay1pdGVtX19jYXB0aW9uXCIpLnRleHRDb250ZW50ICE9IGNoZWNrZWRWYWx1ZSkge1xuICAgICAgICAgICAgZmVlZGJhY2suY2xhc3NMaXN0LmFkZChcImpzLS1oaWRkZW5cIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmZWVkYmFjay5jbGFzc0xpc3QucmVtb3ZlKFwianMtLWhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgIH0pXG59IiwiY29uc3Qgc3dpcGVyID0gbmV3IFN3aXBlcignI3dvcmtlclN3aXBlcicsIHtcbiAgICAvLyBPcHRpb25hbCBwYXJhbWV0ZXJzXG4gICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXG4gICAgbG9vcDogdHJ1ZSxcbiAgICBzcGVlZDogNDAwLFxuICAgIHNwYWNlQmV0d2VlbjogMzQsXG4gICAgZWZmZWN0OiAnY2FyZHMnLFxuICAgIHNsaWRlc1BlclZpZXc6ICc0JyxcbiAgICBzd2lwZUhhbmRsZXI6ICcuc3dpcGVyLXdyYXBwZXInLFxufSk7XG5jb25zdCBzd2lwZXJJbWFnZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJhdGhyb29tLXByZXZpZXdcIik7XG5jb25zb2xlLmxvZyhzd2lwZXJJbWFnZXMpO1xubGV0IGltZ0xpbmtBcnJheSA9IG5ldyBBcnJheSgpO1xubGV0IHJldHVyblZhbHVlID0gMDtcbnN3aXBlckltYWdlcy5mb3JFYWNoKGltYWdlID0+IHtcbiAgICBjb25zdCBpbWFnZVNyYyA9IGltYWdlLnNyYy5yZXBsYWNlKFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIFwiLlwiKTtcbiAgICB2YXIgcmV0dXJuVmFsdWUgPSBgPGltZyBjbGFzcz1cInN3aXBlci1wcmV2aWV3IHN3aXBlci1wYWdpbmF0aW9uLWJ1bGxldFwiIHNyYz0ke2ltYWdlU3JjfT5gO1xuICAgIGltZ0xpbmtBcnJheS5wdXNoKHJldHVyblZhbHVlKVxufSlcblxuY29uc3QgZmFuY3lTd2lwZXIgPSBuZXcgU3dpcGVyKCcjZmFuY3lTd2lwZXInLCB7XG4gICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXG4gICAgbG9vcDogdHJ1ZSxcbiAgICBzcGVlZDogNTAwLFxuICAgIHNwYWNlQmV0d2VlbjogMzQsXG4gICAgZWZmZWN0OiAnZmFkZScsXG4gICAgZmFkZUVmZmVjdDoge1xuICAgICAgICBjcm9zc0ZhZGU6IHRydWVcbiAgICB9LFxuICAgIHNsaWRlc1BlclZpZXc6ICcxJyxcbiAgICBzd2lwZUhhbmRsZXI6ICcuc3dpcGVyLXdyYXBwZXInLFxuICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6ICcuc3dpcGVyLXBhZ2luYXRpb24nLFxuICAgICAgICBjbGlja2FibGU6IHRydWUsXG4gICAgICAgIHJlbmRlckJ1bGxldDogZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gaW1nTGlua0FycmF5W2luZGV4XTtcbiAgICAgICAgfSxcbiAgICB9XG59KTsiXX0=
