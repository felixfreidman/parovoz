"use strict";function inputAuthorization(){document.querySelectorAll(".form-input").forEach(function(e){var r;e.value||(r=addWarningEmptySpan(),e.classList.add("form-input--warning"),e=e.id,document.querySelector("[for=".concat(e,"]")).appendChild(r))})}function addWarningEmptySpan(){var e=document.createElement("span");return e.classList.add("empty--input"),e}function deleteWarningSpans(){document.querySelectorAll(".form-input").forEach(function(r){r.addEventListener("input",function(){var e=r.id,e=document.querySelector("[for=".concat(e,"]"));e.querySelector(".empty--input")&&(e.querySelector(".empty--input").remove(),r.classList.remove("form-input--warning"))})})}function eraseLocalStorage(){localStorage.removeItem("globalCounter"),localStorage.removeItem("bookedServices")}$(function(){$("#orderForm").on("submit",function(e){e.preventDefault();var r=$("#userName").val(),t=$("#userPhone").val(),o=$("#userEmail").val(),e=$("#userOrder").val(),n=document.querySelector(".order-button");n.textContent="Подтверждаем",$.ajax({type:"post",url:"/wp-admin/admin-ajax.php",data:{action:"ajax_form",name:r,phone:t,mail:o,order:e},success:function(e){n.textContent=e,setTimeout(eraseLocalStorage,300),setTimeout(function(){window.location.href="https://parovoz.yurin.biz/product/single-product/"},1200)}})})}),$(".order-button").on("click",function(){inputAuthorization()}),deleteWarningSpans(),Storage.prototype.setObj=function(e,r){return this.setItem(e,JSON.stringify(r))},Storage.prototype.getObj=function(e){return JSON.parse(this.getItem(e))};var globalCounter=0;localStorage.getItem("globalCounter")&&(globalCounter=localStorage.getItem("globalCounter"));var cardsArray,createBookingItem,bookBtn,createServiceOrder,createServiceTotal,updateUserOrderField,updateTotalNumber,deleteOrderFromLists,bookedItems,orderContainer,orderList,counter,booksArray=new Array;localStorage.getObj("bookedServices")&&(booksArray=localStorage.getObj("bookedServices")),document.querySelector(".article-card")&&(cardsArray=document.querySelectorAll(".article-card")).forEach(function(r){r.addEventListener("mouseover",function(){var e=(e=r.style.background).replace("linear-gradient(360deg, rgba(26, 47, 68, 0.9) 0%, rgba(26, 47, 68, 0) 100%)","linear-gradient( 360deg, rgba(212, 37, 21, 0.8) 0%, rgba(212, 37, 21, 0) 100%)");r.style.background=e}),r.addEventListener("mouseout",function(){var e=(e=r.style.background).replace("linear-gradient(360deg, rgba(212, 37, 21, 0.8) 0%, rgba(212, 37, 21, 0) 100%)","linear-gradient(360deg, rgba(26, 47, 68, 0.9) 0%, rgba(26, 47, 68, 0) 100%)");r.style.background=e})}),document.getElementById("orderDate")&&(document.getElementById("orderDate").valueAsDate=new Date),window.location.href.includes("product")&&(createBookingItem=function(){var e=document.querySelector(".service-header").textContent,r=document.querySelector(".price-tag").textContent,t=document.querySelector(".description-content").textContent,t={serviceCounter:parseInt(globalCounter),serviceName:e,servicePrice:r,serviceDescription:t};booksArray.push(t),localStorage.setObj("bookedServices",booksArray),localStorage.setItem("globalCounter",globalCounter),globalCounter++,window.location.href="book"},(bookBtn=document.querySelector(".service-data__book-btn")).addEventListener("click",createBookingItem)),window.location.href.includes("book")&&(createServiceOrder=function(e,r,t,o){return'\n    <div class="order-container order-service" id="service'.concat(o,'">\n    <div class="cross" id="cross').concat(o,'">\n        <div class="cross-one"> </div>\n        <div class="cross-two"></div>\n    </div>\n    <div class="order-row">\n        <div class="order-info">\n            <div class="order-header">').concat(e,'</div>\n            <div class="order-cost">').concat(r,' ₽ / час</div>\n        </div>\n    </div>\n    <div class="order-content">\n        <div class="content-header">Описание</div>\n        <div class="content-description">\n            <div>').concat(t,"</div>\n        </div>\n    </div>\n</div>\n    ")},createServiceTotal=function(e,r,t){return'\n      <div class="order-item order-item--service" id="totalOrderID'.concat(t,'">\n        <div class="order-item__name" id="orderServiceName">').concat(e,'</div>\n        <div class="order-item__bar"> </div>\n        <div class="order-item__price" id="orderServicePrice">').concat(r," <span>₽</span></div>\n    </div>\n    ")},updateUserOrderField=function(){var e=document.getElementById("userOrder"),r=document.querySelectorAll(".order-item"),t=document.getElementById("orderTotalPrice").textContent,o="";r.forEach(function(e){var r=e.querySelector(".order-item__name").textContent,e=e.querySelector(".order-item__price").textContent;o="".concat(o," ").concat(r," - ").concat(e,".  ")});t="Всего: ".concat(t);o+=t,e.value=o,console.log(e.value)},updateTotalNumber=function(){var e,r,t;document.querySelectorAll(".order-item__price")?(e=document.querySelectorAll(".order-item__price"),r=document.getElementById("orderTotalPrice"),t=0,e.forEach(function(e){e=parseInt(e.textContent);t+=e}),r.childNodes[0].nodeValue=t+" "):document.getElementById("orderTotalPrice").childNodes[0].nodeValue="0 "},deleteOrderFromLists=function(){var e=document.querySelectorAll(".cross"),n=document.querySelector(".orders-container"),a=document.querySelector(".order-list");e.forEach(function(t){t.addEventListener("click",function(){var o=t.id.replace("cross",""),e=document.getElementById("service".concat(o)),r=document.getElementById("totalOrderID".concat(o));n.removeChild(e),a.removeChild(r),updateTotalNumber(),updateUserOrderField();o=parseInt(o),r=booksArray.filter(function(e,r,t){return(e=e.serviceCounter)!=o});localStorage.setObj("bookedServices",r)})})},bookedItems=localStorage.getObj("bookedServices"),orderContainer=document.querySelector(".orders-container"),orderList=document.querySelector(".order-list"),counter=0,bookedItems.forEach(function(e){var r=e.serviceName,t=e.servicePrice,o=e.serviceDescription,e=e.serviceCounter,o=createServiceOrder(r,t,o,e),e=createServiceTotal(r,t,e);orderContainer.insertAdjacentHTML("beforeend",o),orderList.insertAdjacentHTML("beforeend",e)}),setTimeout(updateTotalNumber,100),setTimeout(deleteOrderFromLists,100),setTimeout(updateUserOrderField,100),$(document).ready(function(){$("#userPhone").inputmask()})),$("#slider").slider({animate:"fast",max:5,min:1,step:1,value:5,range:!0,values:[1,5],slide:function(e,r){$("#starRating").val(r.value)}});var swiper=new Swiper("#workerSwiper",{direction:"horizontal",loop:!0,speed:400,spaceBetween:34,effect:"cards",slidesPerView:"4",swipeHandler:".swiper-wrapper"}),swiperImages=document.querySelectorAll(".bathroom-preview");console.log(swiperImages);var imgLinkArray=new Array,returnValue=0;swiperImages.forEach(function(e){e=e.src.replace("http://localhost:3000","."),e='<img class="swiper-preview swiper-pagination-bullet" src='.concat(e,">");imgLinkArray.push(e)});var fancySwiper=new Swiper("#fancySwiper",{direction:"horizontal",loop:!0,speed:500,spaceBetween:34,effect:"fade",fadeEffect:{crossFade:!0},slidesPerView:"1",swipeHandler:".swiper-wrapper",pagination:{el:".swiper-pagination",clickable:!0,renderBullet:function(e){return imgLinkArray[e]}}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFqYXguanMiLCJjb21tb24uanMiLCJmZWVkYmFjay5qcyIsInN3aXBlci5qcyJdLCJuYW1lcyI6WyJpbnB1dEF1dGhvcml6YXRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaW5wdXQiLCJzcGFuIiwidmFsdWUiLCJhZGRXYXJuaW5nRW1wdHlTcGFuIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5wdXRJRCIsImlkIiwicXVlcnlTZWxlY3RvciIsImNvbmNhdCIsImFwcGVuZENoaWxkIiwid2FybmluZ0VtcHR5U3BhbiIsImNyZWF0ZUVsZW1lbnQiLCJkZWxldGVXYXJuaW5nU3BhbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5wdXRMYWJlbCIsInJlbW92ZSIsImVyYXNlTG9jYWxTdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwicmVtb3ZlSXRlbSIsIiQiLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIm5hbWUiLCJ2YWwiLCJwaG9uZSIsIm1haWwiLCJvcmRlciIsIm9yZGVyQnV0dG9uIiwidGV4dENvbnRlbnQiLCJhamF4IiwidHlwZSIsInVybCIsImRhdGEiLCJhY3Rpb24iLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzZXRUaW1lb3V0Iiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiU3RvcmFnZSIsInByb3RvdHlwZSIsInNldE9iaiIsImtleSIsIm9iaiIsInRoaXMiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldE9iaiIsInBhcnNlIiwiZ2V0SXRlbSIsImdsb2JhbENvdW50ZXIiLCJjYXJkc0FycmF5IiwiY3JlYXRlQm9va2luZ0l0ZW0iLCJib29rQnRuIiwiY3JlYXRlU2VydmljZU9yZGVyIiwiY3JlYXRlU2VydmljZVRvdGFsIiwidXBkYXRlVXNlck9yZGVyRmllbGQiLCJ1cGRhdGVUb3RhbE51bWJlciIsImRlbGV0ZU9yZGVyRnJvbUxpc3RzIiwiYm9va2VkSXRlbXMiLCJvcmRlckNvbnRhaW5lciIsIm9yZGVyTGlzdCIsImNvdW50ZXIiLCJib29rc0FycmF5IiwiQXJyYXkiLCJjYXJkIiwiYmFja2dyb3VuZCIsInN0eWxlIiwicmVwbGFjZSIsImdldEVsZW1lbnRCeUlkIiwidmFsdWVBc0RhdGUiLCJEYXRlIiwiaW5jbHVkZXMiLCJzZXJ2aWNlTmFtZSIsInNlcnZpY2VQcmljZSIsInNlcnZpY2VEZXNjcmlwdGlvbiIsImJvb2tPYmoiLCJzZXJ2aWNlQ291bnRlciIsInBhcnNlSW50IiwicHVzaCIsInByaWNlIiwiZGVzY3JpcHRpb24iLCJ1c2VyT3JkZXJGaWVsZCIsInVzZXJPcmRlckxpc3QiLCJ0b3RhbFByaWNlIiwib3JkZXJTdHJpbmciLCJvcmRlck5hbWUiLCJvcmRlclByaWNlIiwidG90YWxTdHJpbmciLCJjb25zb2xlIiwibG9nIiwiYWxsT3JkZXJzTnVtcyIsInRvdGFsTnVtIiwidG90YWxTdW0iLCJyZWFsUHJpY2UiLCJjaGlsZE5vZGVzIiwibm9kZVZhbHVlIiwiYWxsQ3Jvc3NlcyIsImNyb3NzIiwiY3Jvc3NDb3VudGVyIiwib3JkZXJJdGVtIiwib3JkZXJUb3RhbEl0ZW0iLCJyZW1vdmVDaGlsZCIsImZpbHRlcmVkQXJyYXkiLCJmaWx0ZXIiLCJpbmRleCIsImFyciIsInJlYWR5T3JkZXIiLCJ0b3RhbE9yZGVyIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwicmVhZHkiLCJpbnB1dG1hc2siLCJzbGlkZXIiLCJhbmltYXRlIiwibWF4IiwibWluIiwic3RlcCIsInJhbmdlIiwidmFsdWVzIiwic2xpZGUiLCJldmVudCIsInVpIiwic3dpcGVyIiwiU3dpcGVyIiwiZGlyZWN0aW9uIiwibG9vcCIsInNwZWVkIiwic3BhY2VCZXR3ZWVuIiwiZWZmZWN0Iiwic2xpZGVzUGVyVmlldyIsInN3aXBlSGFuZGxlciIsInN3aXBlckltYWdlcyIsImltZ0xpbmtBcnJheSIsInJldHVyblZhbHVlIiwiaW1hZ2UiLCJpbWFnZVNyYyIsInNyYyIsImZhbmN5U3dpcGVyIiwiZmFkZUVmZmVjdCIsImNyb3Nz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QUFBdEMsR0FDQSxPQUFBMkIsYUFBQTNCIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBSkFYLdC30LDQv9GA0L7RgSDQtNC70Y8g0L7RgtC/0YDQsNCy0LrQuCDRgdC+0L7QsdGJ0LXQvdC40Lkg0L3QsCDQv9C+0YfRgtGDLCDQutC+0YLQvtGA0LDRjyDRg9C60LDQt9Cw0L3QsCDQsiDQsNC00LzQuNC90LrQtSDRgdCw0LnRgtCwXG4kKGZ1bmN0aW9uICgpIHtcbiAgICAkKFwiI29yZGVyRm9ybVwiKS5vbihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciBuYW1lID0gJChcIiN1c2VyTmFtZVwiKS52YWwoKTtcbiAgICAgICAgdmFyIHBob25lID0gJChcIiN1c2VyUGhvbmVcIikudmFsKCk7XG4gICAgICAgIHZhciBtYWlsID0gJChcIiN1c2VyRW1haWxcIikudmFsKCk7XG4gICAgICAgIHZhciBvcmRlciA9ICQoXCIjdXNlck9yZGVyXCIpLnZhbCgpO1xuICAgICAgICB2YXIgb3JkZXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcub3JkZXItYnV0dG9uJyk7XG4gICAgICAgIG9yZGVyQnV0dG9uLnRleHRDb250ZW50ID0gXCLQn9C+0LTRgtCy0LXRgNC20LTQsNC10LxcIjtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZTogXCJwb3N0XCIsXG4gICAgICAgICAgICB1cmw6IFwiL3dwLWFkbWluL2FkbWluLWFqYXgucGhwXCIsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBcImFqYXhfZm9ybVwiLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLFxuICAgICAgICAgICAgICAgIG1haWw6IG1haWwsXG4gICAgICAgICAgICAgICAgb3JkZXI6IG9yZGVyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG9yZGVyQnV0dG9uLnRleHRDb250ZW50ID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChlcmFzZUxvY2FsU3RvcmFnZSwgMzAwKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHBzOi8vcGFyb3Zvei55dXJpbi5iaXovcHJvZHVjdC9zaW5nbGUtcHJvZHVjdC9cIjtcbiAgICAgICAgICAgICAgICB9LCAxMjAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4vLyDQn9GA0L7QstC10YDRj9C10LwsINGH0YLQviDQstGB0LUg0L/QvtC70Y8g0LLQsNC20L3Ri9C1INC30LDQv9C+0LvQvdC10L3Ri1xuJChcIi5vcmRlci1idXR0b25cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgaW5wdXRBdXRob3JpemF0aW9uKCk7XG59KTtcbi8vICAgXG4vLyDQodCw0LzQsCDRhNGD0L3QutGG0LjRjyDQv9GA0L7QstC10YDQutC4INC/0L7Qu9C10Lkg0Lgg0LTQvtCx0LDQstC70LXQvdC40Y8g0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90YvRhSDRgdCy0L7QudGB0YLQsiDQv9C+0LvRjlxuZnVuY3Rpb24gaW5wdXRBdXRob3JpemF0aW9uKCkge1xuICAgIGNvbnN0IGlucHV0c0FycmF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtLWlucHV0XCIpO1xuICAgIGlucHV0c0FycmF5LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgIGlmICghaW5wdXQudmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBhZGRXYXJuaW5nRW1wdHlTcGFuKCk7XG4gICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKFwiZm9ybS1pbnB1dC0td2FybmluZ1wiKTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0SUQgPSBpbnB1dC5pZDtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZm9yPSR7aW5wdXRJRH1dYCk7XG4gICAgICAgICAgICBpbnB1dExhYmVsLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8vINCd0LUg0YXQvtGC0LXQuyDQv9C10YDQtdCz0YDRg9C20LDRgtGMINGE0YPQvdC60YbQuNGPINC/0YDQvtCy0LXRgNC60Lgg0Lgg0L/RgNC+0YfQtdC1LCDQv9C+0Y3RgtC+0LzRgyDRgdC+0LfQtNCw0L3QuNC1INC+0YLQtNC10LvRjNC90L7Qs9C+INGB0L/QsNC90LAg0LLRi9C90LXRgSDQvtGC0LTQtdC70YzQvdC+XG5mdW5jdGlvbiBhZGRXYXJuaW5nRW1wdHlTcGFuKCkge1xuICAgIGNvbnN0IHdhcm5pbmdFbXB0eVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICB3YXJuaW5nRW1wdHlTcGFuLmNsYXNzTGlzdC5hZGQoXCJlbXB0eS0taW5wdXRcIik7XG4gICAgcmV0dXJuIHdhcm5pbmdFbXB0eVNwYW47XG59XG4vLyDQmtCw0Log0YLQvtC70YzQutC+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDRgNC10YjQuNC70YHRjyDQstCy0LXRgdGC0Lgg0LTQsNC90L3Ri9C1LCDQtdGB0LvQuCDQsdGL0LvQviDQv9GA0LXQtNGD0L/RgNC10LbQtNC10L3QuNC1INGPINGD0LTQsNC70Y/RjiDQv9GA0LXQtNGD0L/RgNC10LbQtNC10L3QuNGPINCy0YHRj9C60LjQtVxuZnVuY3Rpb24gZGVsZXRlV2FybmluZ1NwYW5zKCkge1xuICAgIGNvbnN0IGlucHV0c0FycmF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtLWlucHV0XCIpO1xuICAgIGlucHV0c0FycmF5LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbnB1dElEID0gaW5wdXQuaWQ7XG4gICAgICAgICAgICBjb25zdCBpbnB1dExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2Zvcj0ke2lucHV0SUR9XWApO1xuICAgICAgICAgICAgaWYgKGlucHV0TGFiZWwucXVlcnlTZWxlY3RvcihcIi5lbXB0eS0taW5wdXRcIikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZXJ0YWluU3BhbiA9IGlucHV0TGFiZWwucXVlcnlTZWxlY3RvcihcIi5lbXB0eS0taW5wdXRcIik7XG4gICAgICAgICAgICAgICAgY2VydGFpblNwYW4ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImZvcm0taW5wdXQtLXdhcm5pbmdcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5kZWxldGVXYXJuaW5nU3BhbnMoKTtcblxuXG4vLyDQp9C40YHRgtC40Lwg0LvQvtC60LDQu9GM0L3QvtC1INGF0YDQsNC90LjQu9C40YnQtVxuZnVuY3Rpb24gZXJhc2VMb2NhbFN0b3JhZ2UoKSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJnbG9iYWxDb3VudGVyXCIpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiYm9va2VkU2VydmljZXNcIik7XG59XG4iLCJTdG9yYWdlLnByb3RvdHlwZS5zZXRPYmogPSBmdW5jdGlvbiAoa2V5LCBvYmopIHtcbiAgcmV0dXJuIHRoaXMuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KG9iaikpXG59XG5TdG9yYWdlLnByb3RvdHlwZS5nZXRPYmogPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiBKU09OLnBhcnNlKHRoaXMuZ2V0SXRlbShrZXkpKVxufVxudmFyIGdsb2JhbENvdW50ZXIgPSAwO1xuaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiZ2xvYmFsQ291bnRlclwiKSkge1xuICBnbG9iYWxDb3VudGVyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJnbG9iYWxDb3VudGVyXCIpO1xufVxuXG5cbmxldCBib29rc0FycmF5ID0gbmV3IEFycmF5KCk7XG5pZiAobG9jYWxTdG9yYWdlLmdldE9iaihcImJvb2tlZFNlcnZpY2VzXCIpKSB7XG4gIGJvb2tzQXJyYXkgPSBsb2NhbFN0b3JhZ2UuZ2V0T2JqKFwiYm9va2VkU2VydmljZXNcIik7XG59XG5cbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFydGljbGUtY2FyZFwiKSkge1xuICBjb25zdCBjYXJkc0FycmF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcnRpY2xlLWNhcmRcIik7XG4gIGNhcmRzQXJyYXkuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG4gICAgICBsZXQgYmFja2dyb3VuZCA9IGNhcmQuc3R5bGUuYmFja2dyb3VuZDtcbiAgICAgIGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kLnJlcGxhY2UoXG4gICAgICAgIFwibGluZWFyLWdyYWRpZW50KDM2MGRlZywgcmdiYSgyNiwgNDcsIDY4LCAwLjkpIDAlLCByZ2JhKDI2LCA0NywgNjgsIDApIDEwMCUpXCIsXG4gICAgICAgIFwibGluZWFyLWdyYWRpZW50KCAzNjBkZWcsIHJnYmEoMjEyLCAzNywgMjEsIDAuOCkgMCUsIHJnYmEoMjEyLCAzNywgMjEsIDApIDEwMCUpXCJcbiAgICAgICk7XG4gICAgICBjYXJkLnN0eWxlLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kO1xuICAgIH0pO1xuICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcbiAgICAgIGxldCBiYWNrZ3JvdW5kID0gY2FyZC5zdHlsZS5iYWNrZ3JvdW5kO1xuICAgICAgYmFja2dyb3VuZCA9IGJhY2tncm91bmQucmVwbGFjZShcbiAgICAgICAgXCJsaW5lYXItZ3JhZGllbnQoMzYwZGVnLCByZ2JhKDIxMiwgMzcsIDIxLCAwLjgpIDAlLCByZ2JhKDIxMiwgMzcsIDIxLCAwKSAxMDAlKVwiLFxuICAgICAgICBcImxpbmVhci1ncmFkaWVudCgzNjBkZWcsIHJnYmEoMjYsIDQ3LCA2OCwgMC45KSAwJSwgcmdiYSgyNiwgNDcsIDY4LCAwKSAxMDAlKVwiXG4gICAgICApO1xuICAgICAgY2FyZC5zdHlsZS5iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcbiAgICB9KTtcbiAgfSk7XG59XG5pZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcmRlckRhdGVcIikpIHtcblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3JkZXJEYXRlJykudmFsdWVBc0RhdGUgPSBuZXcgRGF0ZSgpO1xufVxuXG5cbmlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcyhcInByb2R1Y3RcIikpIHtcblxuICBjb25zdCBib29rQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zZXJ2aWNlLWRhdGFfX2Jvb2stYnRuXCIpO1xuXG4gIGJvb2tCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNyZWF0ZUJvb2tpbmdJdGVtKTtcblxuICBmdW5jdGlvbiBjcmVhdGVCb29raW5nSXRlbSgpIHtcbiAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VydmljZS1oZWFkZXJcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc3Qgc2VydmljZVByaWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmljZS10YWdcIikudGV4dENvbnRlbnQ7XG4gICAgY29uc3Qgc2VydmljZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kZXNjcmlwdGlvbi1jb250ZW50XCIpLnRleHRDb250ZW50O1xuICAgIGNvbnN0IGJvb2tPYmogPSB7XG4gICAgICBzZXJ2aWNlQ291bnRlcjogcGFyc2VJbnQoZ2xvYmFsQ291bnRlciksXG4gICAgICBzZXJ2aWNlTmFtZTogc2VydmljZU5hbWUsXG4gICAgICBzZXJ2aWNlUHJpY2U6IHNlcnZpY2VQcmljZSxcbiAgICAgIHNlcnZpY2VEZXNjcmlwdGlvbjogc2VydmljZURlc2NyaXB0aW9uLFxuICAgIH1cbiAgICBib29rc0FycmF5LnB1c2goYm9va09iaik7XG4gICAgbG9jYWxTdG9yYWdlLnNldE9iaihcImJvb2tlZFNlcnZpY2VzXCIsIGJvb2tzQXJyYXkpO1xuXG5cbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImdsb2JhbENvdW50ZXJcIiwgZ2xvYmFsQ291bnRlcik7XG4gICAgZ2xvYmFsQ291bnRlcisrO1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJib29rXCJcblxuXG4gIH1cblxufVxuXG5pZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoXCJib29rXCIpKSB7XG4gIHZhciBib29rZWRJdGVtcyA9IGxvY2FsU3RvcmFnZS5nZXRPYmooXCJib29rZWRTZXJ2aWNlc1wiKTtcbiAgdmFyIG9yZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vcmRlcnMtY29udGFpbmVyXCIpO1xuICB2YXIgb3JkZXJMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vcmRlci1saXN0XCIpO1xuICBsZXQgY291bnRlciA9IDA7XG4gIGJvb2tlZEl0ZW1zLmZvckVhY2gob3JkZXIgPT4ge1xuICAgIGNvbnN0IHNlcnZpY2VOYW1lID0gb3JkZXIuc2VydmljZU5hbWU7XG4gICAgY29uc3Qgc2VydmljZVByaWNlID0gb3JkZXIuc2VydmljZVByaWNlO1xuICAgIGNvbnN0IHNlcnZpY2VEZXNjcmlwdGlvbiA9IG9yZGVyLnNlcnZpY2VEZXNjcmlwdGlvbjtcbiAgICBjb25zdCBzZXJ2aWNlQ291bnRlciA9IG9yZGVyLnNlcnZpY2VDb3VudGVyO1xuXG4gICAgY29uc3QgcmVhZHlPcmRlciA9IGNyZWF0ZVNlcnZpY2VPcmRlcihzZXJ2aWNlTmFtZSwgc2VydmljZVByaWNlLCBzZXJ2aWNlRGVzY3JpcHRpb24sIHNlcnZpY2VDb3VudGVyKVxuICAgIGNvbnN0IHRvdGFsT3JkZXIgPSBjcmVhdGVTZXJ2aWNlVG90YWwoc2VydmljZU5hbWUsIHNlcnZpY2VQcmljZSwgc2VydmljZUNvdW50ZXIpO1xuXG4gICAgb3JkZXJDb250YWluZXIuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCByZWFkeU9yZGVyKTtcbiAgICBvcmRlckxpc3QuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCB0b3RhbE9yZGVyKTtcbiAgfSlcblxuICBmdW5jdGlvbiBjcmVhdGVTZXJ2aWNlT3JkZXIobmFtZSwgcHJpY2UsIGRlc2NyaXB0aW9uLCBpZCkge1xuICAgIGNvbnN0IEhUTUxTdHJpbmcgPSBgXG4gICAgPGRpdiBjbGFzcz1cIm9yZGVyLWNvbnRhaW5lciBvcmRlci1zZXJ2aWNlXCIgaWQ9XCJzZXJ2aWNlJHtpZH1cIj5cbiAgICA8ZGl2IGNsYXNzPVwiY3Jvc3NcIiBpZD1cImNyb3NzJHtpZH1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNyb3NzLW9uZVwiPiA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNyb3NzLXR3b1wiPjwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJvcmRlci1yb3dcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm9yZGVyLWluZm9cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJvcmRlci1oZWFkZXJcIj4ke25hbWV9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib3JkZXItY29zdFwiPiR7cHJpY2V9IOKCvSAvINGH0LDRgTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwib3JkZXItY29udGVudFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGVudC1oZWFkZXJcIj7QntC/0LjRgdCw0L3QuNC1PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50LWRlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICA8ZGl2PiR7ZGVzY3JpcHRpb259PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuPC9kaXY+XG4gICAgYDtcbiAgICByZXR1cm4gSFRNTFN0cmluZztcbiAgfVxuICBmdW5jdGlvbiBjcmVhdGVTZXJ2aWNlVG90YWwobmFtZSwgcHJpY2UsIGlkKSB7XG4gICAgY29uc3QgSFRNTFN0cmluZyA9XG4gICAgICBgXG4gICAgICA8ZGl2IGNsYXNzPVwib3JkZXItaXRlbSBvcmRlci1pdGVtLS1zZXJ2aWNlXCIgaWQ9XCJ0b3RhbE9yZGVySUQke2lkfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwib3JkZXItaXRlbV9fbmFtZVwiIGlkPVwib3JkZXJTZXJ2aWNlTmFtZVwiPiR7bmFtZX08L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm9yZGVyLWl0ZW1fX2JhclwiPiA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIm9yZGVyLWl0ZW1fX3ByaWNlXCIgaWQ9XCJvcmRlclNlcnZpY2VQcmljZVwiPiR7cHJpY2V9IDxzcGFuPuKCvTwvc3Bhbj48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgO1xuICAgIHJldHVybiBIVE1MU3RyaW5nO1xuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlVXNlck9yZGVyRmllbGQoKSB7XG4gICAgY29uc3QgdXNlck9yZGVyRmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVzZXJPcmRlclwiKTtcbiAgICBjb25zdCB1c2VyT3JkZXJMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5vcmRlci1pdGVtXCIpO1xuICAgIGNvbnN0IHRvdGFsUHJpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm9yZGVyVG90YWxQcmljZVwiKS50ZXh0Q29udGVudDtcbiAgICBsZXQgb3JkZXJTdHJpbmcgPSAnJztcbiAgICB1c2VyT3JkZXJMaXN0LmZvckVhY2gob3JkZXIgPT4ge1xuICAgICAgY29uc3Qgb3JkZXJOYW1lID0gb3JkZXIucXVlcnlTZWxlY3RvcihcIi5vcmRlci1pdGVtX19uYW1lXCIpLnRleHRDb250ZW50O1xuICAgICAgY29uc3Qgb3JkZXJQcmljZSA9IG9yZGVyLnF1ZXJ5U2VsZWN0b3IoXCIub3JkZXItaXRlbV9fcHJpY2VcIikudGV4dENvbnRlbnQ7XG4gICAgICBvcmRlclN0cmluZyA9IGAke29yZGVyU3RyaW5nfSAke29yZGVyTmFtZX0gLSAke29yZGVyUHJpY2V9LiAgYFxuICAgIH0pO1xuICAgIGxldCB0b3RhbFN0cmluZyA9IGDQktGB0LXQs9C+OiAke3RvdGFsUHJpY2V9YDtcbiAgICBvcmRlclN0cmluZyArPSB0b3RhbFN0cmluZztcbiAgICB1c2VyT3JkZXJGaWVsZC52YWx1ZSA9IG9yZGVyU3RyaW5nO1xuICAgIGNvbnNvbGUubG9nKHVzZXJPcmRlckZpZWxkLnZhbHVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZVRvdGFsTnVtYmVyKCkge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm9yZGVyLWl0ZW1fX3ByaWNlXCIpKSB7XG4gICAgICBjb25zdCBhbGxPcmRlcnNOdW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5vcmRlci1pdGVtX19wcmljZVwiKTtcbiAgICAgIGNvbnN0IHRvdGFsTnVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcmRlclRvdGFsUHJpY2VcIik7XG4gICAgICBsZXQgdG90YWxTdW0gPSAwO1xuICAgICAgYWxsT3JkZXJzTnVtcy5mb3JFYWNoKHByaWNlID0+IHtcbiAgICAgICAgdmFyIHJlYWxQcmljZSA9IHBhcnNlSW50KHByaWNlLnRleHRDb250ZW50KVxuICAgICAgICB0b3RhbFN1bSArPSByZWFsUHJpY2U7XG4gICAgICB9KVxuICAgICAgbGV0IHRvdGFsTnVtRmluYWwgPSB0b3RhbE51bS5jaGlsZE5vZGVzWzBdO1xuICAgICAgdG90YWxOdW1GaW5hbC5ub2RlVmFsdWUgPSB0b3RhbFN1bSArICcgJztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBjb25zdCB0b3RhbE51bSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3JkZXJUb3RhbFByaWNlXCIpO1xuICAgICAgbGV0IHRvdGFsU3VtID0gMDtcbiAgICAgIGxldCB0b3RhbE51bUZpbmFsID0gdG90YWxOdW0uY2hpbGROb2Rlc1swXTtcbiAgICAgIHRvdGFsTnVtRmluYWwubm9kZVZhbHVlID0gdG90YWxTdW0gKyAnICc7XG4gICAgfVxuICB9XG4gIHNldFRpbWVvdXQodXBkYXRlVG90YWxOdW1iZXIsIDEwMClcbiAgc2V0VGltZW91dChkZWxldGVPcmRlckZyb21MaXN0cywgMTAwKVxuICBzZXRUaW1lb3V0KHVwZGF0ZVVzZXJPcmRlckZpZWxkLCAxMDApXG5cbiAgZnVuY3Rpb24gZGVsZXRlT3JkZXJGcm9tTGlzdHMoKSB7XG4gICAgY29uc3QgYWxsQ3Jvc3NlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY3Jvc3NcIik7XG4gICAgdmFyIG9yZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vcmRlcnMtY29udGFpbmVyXCIpO1xuICAgIHZhciBvcmRlckxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm9yZGVyLWxpc3RcIik7XG4gICAgYWxsQ3Jvc3Nlcy5mb3JFYWNoKGNyb3NzID0+IHtcbiAgICAgIGNyb3NzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGxldCBjcm9zc0NvdW50ZXIgPSBjcm9zcy5pZC5yZXBsYWNlKCdjcm9zcycsICcnKTtcblxuICAgICAgICBjb25zdCBvcmRlckl0ZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgc2VydmljZSR7Y3Jvc3NDb3VudGVyfWApO1xuICAgICAgICBjb25zdCBvcmRlclRvdGFsSXRlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB0b3RhbE9yZGVySUQke2Nyb3NzQ291bnRlcn1gKTtcbiAgICAgICAgb3JkZXJDb250YWluZXIucmVtb3ZlQ2hpbGQob3JkZXJJdGVtKTtcbiAgICAgICAgb3JkZXJMaXN0LnJlbW92ZUNoaWxkKG9yZGVyVG90YWxJdGVtKTtcbiAgICAgICAgdXBkYXRlVG90YWxOdW1iZXIoKTtcbiAgICAgICAgdXBkYXRlVXNlck9yZGVyRmllbGQoKVxuXG4gICAgICAgIGNyb3NzQ291bnRlciA9IHBhcnNlSW50KGNyb3NzQ291bnRlcik7XG4gICAgICAgIHZhciBmaWx0ZXJlZEFycmF5ID0gYm9va3NBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCwgYXJyKSB7XG4gICAgICAgICAgdmFsdWUgPSB2YWx1ZS5zZXJ2aWNlQ291bnRlcjtcbiAgICAgICAgICByZXR1cm4gdmFsdWUgIT0gY3Jvc3NDb3VudGVyO1xuICAgICAgICB9KTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldE9iaihcImJvb2tlZFNlcnZpY2VzXCIsIGZpbHRlcmVkQXJyYXkpO1xuICAgICAgfSlcbiAgICB9KVxuICB9XG4gICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAkKFwiI3VzZXJQaG9uZVwiKS5pbnB1dG1hc2soKTtcbiAgfSk7XG5cbn1cbiIsIiQoXCIjc2xpZGVyXCIpLnNsaWRlcih7XG4gICAgYW5pbWF0ZTogXCJmYXN0XCIsXG4gICAgbWF4OiA1LFxuICAgIG1pbjogMSxcbiAgICBzdGVwOiAxLFxuICAgIHZhbHVlOiA1LFxuICAgIHJhbmdlOiB0cnVlLFxuICAgIHZhbHVlczogWzEsIDVdLFxuICAgIHNsaWRlOiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG4gICAgICAgICQoXCIjc3RhclJhdGluZ1wiKS52YWwodWkudmFsdWUpO1xuICAgIH1cbn0pOyIsImNvbnN0IHN3aXBlciA9IG5ldyBTd2lwZXIoJyN3b3JrZXJTd2lwZXInLCB7XG4gICAgLy8gT3B0aW9uYWwgcGFyYW1ldGVyc1xuICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxuICAgIGxvb3A6IHRydWUsXG4gICAgc3BlZWQ6IDQwMCxcbiAgICBzcGFjZUJldHdlZW46IDM0LFxuICAgIGVmZmVjdDogJ2NhcmRzJyxcbiAgICBzbGlkZXNQZXJWaWV3OiAnNCcsXG4gICAgc3dpcGVIYW5kbGVyOiAnLnN3aXBlci13cmFwcGVyJyxcbn0pO1xuY29uc3Qgc3dpcGVySW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5iYXRocm9vbS1wcmV2aWV3XCIpO1xuY29uc29sZS5sb2coc3dpcGVySW1hZ2VzKTtcbmxldCBpbWdMaW5rQXJyYXkgPSBuZXcgQXJyYXkoKTtcbmxldCByZXR1cm5WYWx1ZSA9IDA7XG5zd2lwZXJJbWFnZXMuZm9yRWFjaChpbWFnZSA9PiB7XG4gICAgY29uc3QgaW1hZ2VTcmMgPSBpbWFnZS5zcmMucmVwbGFjZShcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiLCBcIi5cIik7XG4gICAgdmFyIHJldHVyblZhbHVlID0gYDxpbWcgY2xhc3M9XCJzd2lwZXItcHJldmlldyBzd2lwZXItcGFnaW5hdGlvbi1idWxsZXRcIiBzcmM9JHtpbWFnZVNyY30+YDtcbiAgICBpbWdMaW5rQXJyYXkucHVzaChyZXR1cm5WYWx1ZSlcbn0pXG5cbmNvbnN0IGZhbmN5U3dpcGVyID0gbmV3IFN3aXBlcignI2ZhbmN5U3dpcGVyJywge1xuICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxuICAgIGxvb3A6IHRydWUsXG4gICAgc3BlZWQ6IDUwMCxcbiAgICBzcGFjZUJldHdlZW46IDM0LFxuICAgIGVmZmVjdDogJ2ZhZGUnLFxuICAgIGZhZGVFZmZlY3Q6IHtcbiAgICAgICAgY3Jvc3NGYWRlOiB0cnVlXG4gICAgfSxcbiAgICBzbGlkZXNQZXJWaWV3OiAnMScsXG4gICAgc3dpcGVIYW5kbGVyOiAnLnN3aXBlci13cmFwcGVyJyxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgIGVsOiAnLnN3aXBlci1wYWdpbmF0aW9uJyxcbiAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxuICAgICAgICByZW5kZXJCdWxsZXQ6IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIGltZ0xpbmtBcnJheVtpbmRleF07XG4gICAgICAgIH0sXG4gICAgfVxufSk7Il19
